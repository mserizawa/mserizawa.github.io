<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>座席シャッフル</title>
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans JP", sans-serif;
            background: radial-gradient(1200px 800px at 70% -10%, #2c3e50 0%, #1e272e 45%, #111 100%);
            color: #f4f6f8;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        header {
            padding: 16px clamp(16px, 4vw, 32px);
            display: grid;
            gap: 12px;
            background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
            border-bottom: 1px solid rgba(255,255,255,0.08);
            backdrop-filter: blur(6px);
            position: sticky;
            top: 0;
            z-index: 2;
        }
        header h1 {
            margin: 0 0 4px 0;
            font-size: clamp(18px, 2.6vw, 24px);
            letter-spacing: .02em;
        }
        .controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        @media (min-width: 840px) {
            .controls {
                grid-template-columns: 1.4fr .8fr .8fr auto auto;
                align-items: start;
            }
        }

        .field {
            display: grid;
            gap: 6px;
        }
        .field label {
            font-size: 12px;
            color: #d0d6db;
            letter-spacing: .02em;
        }
        textarea, input[type="number"] {
            width: 100%;
            padding: 10px 12px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.14);
            background: rgba(0,0,0,0.35);
            color: #f4f6f8;
            resize: vertical;
            min-height: 44px;
            outline: none;
        }
        textarea::placeholder, input::placeholder {
            color: #a7b0b7;
        }
        .btn {
            appearance: none;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            background: linear-gradient(135deg, #00c6ff, #0072ff);
            color: #fff;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 114, 255, .35);
            transition: transform .12s ease, filter .12s ease;
            white-space: nowrap;
        }
        .btn.secondary {
            background: linear-gradient(135deg, #7f53ac, #647dee);
            box-shadow: 0 6px 20px rgba(100, 125, 238, .28);
        }
        .btn:hover { transform: translateY(-1px); filter: brightness(1.05); }
        .btn:active { transform: translateY(0); filter: brightness(.98); }

        main {
            padding: 8px clamp(16px, 4vw, 32px) 40px;
            flex: 1;
            display: grid;
            gap: 16px;
        }

        .board {
            display: grid;
            gap: 16px;
        }

        /* 席のグリッド */
        .seats {
            display: grid;
            gap: 16px;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }

        /* 席カード */
        .seat {
            position: relative;
            padding: 14px 14px 16px;
            border-radius: 16px;
            background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
            overflow: hidden;
            transform: translateY(8px);
            opacity: 0;
            animation: seatIn .45s ease forwards;
        }
        @keyframes seatIn {
            to { transform: translateY(0); opacity: 1; }
        }

        .seat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            margin-bottom: 12px;
        }
        .seat-name {
            display: inline-grid;
            place-items: center;
            width: 36px; height: 36px;
            border-radius: 10px;
            font-weight: 900;
            background: linear-gradient(135deg, #ffb75e, #ed8f03);
            color: #1b1f23;
            box-shadow: inset 0 1px 0 rgba(255,255,255,.4), 0 6px 16px rgba(237, 143, 3, .35);
        }
        .seat-capacity {
            font-size: 12px;
            color: #c7cfd6;
        }

        /* 参加者チップ */
        .people {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .chip {
            --delay: 0ms;
            padding: 8px 10px;
            border-radius: 999px;
            background: rgba(255,255,255,0.10);
            border: 1px solid rgba(255,255,255,0.18);
            color: #e8ecf1;
            font-weight: 600;
            letter-spacing: .02em;
            transform: scale(.9) translateY(6px);
            opacity: 0;
            animation: chipPop .38s cubic-bezier(.2,.9,.2,1.2) forwards;
            animation-delay: var(--delay);
            white-space: nowrap;
            backdrop-filter: blur(2px);
        }
        @keyframes chipPop {
            40% { transform: scale(1.06) translateY(0); opacity: 1; }
            100% { transform: scale(1) translateY(0); opacity: 1; }
        }

        /* シャッフル時の軽いフローティング */
        .floating .chip {
            animation: floaty 1.2s ease-in-out infinite alternate;
        }
        @keyframes floaty {
            from { transform: translateY(-2px); }
            to   { transform: translateY(2px); }
        }

        /* 下部フッター */
        footer {
            padding: 10px 16px 18px;
            text-align: center;
            font-size: 12px;
            color: #9aa6b2;
        }

        .inline {
            display: flex;
            gap: 10px;
            align-items: center;
        }
    </style>
</head>
<body>
    <header>
        <h1>座席シャッフル</h1>
        <div class="controls">
            <div class="field">
                <label for="names">参加者（改行区切り）</label>
                <textarea id="names" placeholder="例）&#10;山田 太郎&#10;佐藤 花子&#10;John Doe" spellcheck="false">山田 太郎
佐藤 花子
鈴木 次郎
田中 美咲
高橋 健
伊藤 さくら
渡辺 太一
小林 真央
加藤 翔
吉田 未来
中村 優
山本 拓
</textarea>
            </div>
            <div class="field">
                <label for="seatCount">席数（A, B, C...）</label>
                <input id="seatCount" type="number" min="1" max="10" value="4" />
            </div>
            <div class="field">
                <label for="capacity">1席の定員</label>
                <input id="capacity" type="number" min="1" max="6" value="4" />
            </div>
            <div class="inline">
                <button id="shuffleBtn" class="btn">シャッフル</button>
                <button id="clearBtn" class="btn secondary">クリア</button>
            </div>
        </div>
    </header>

    <main>
        <div class="board">
            <div id="seats" class="seats" aria-live="polite"></div>
        </div>
    </main>

    <footer>席名は A, B, C... の順で付与されます。席数/定員を変更して「シャッフル」を押してください。</footer>

    <script>
        // 席名を A, B, ... Z, AA, AB... と生成
        function seatLabel(index) {
            let n = index, label = "";
            while (n >= 0) {
                label = String.fromCharCode(65 + (n % 26)) + label;
                n = Math.floor(n / 26) - 1;
            }
            return label;
        }

        // 配列をシャッフル（Fisher–Yates）
        function shuffle(array) {
            const a = array.slice();
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        // テキストエリアから参加者配列を取得
        function getParticipants() {
            const raw = document.getElementById('names').value
                .split(/\r?\n/)
                .map(s => s.trim())
                .filter(s => s.length > 0);
            return raw;
        }

        // 席レイアウトを生成
        function buildSeats(container, seatCount, capacity) {
            container.innerHTML = "";
            for (let i = 0; i < seatCount; i++) {
                const seat = document.createElement('div');
                seat.className = 'seat';
                seat.style.animationDelay = `${i * 40}ms`;

                const header = document.createElement('div');
                header.className = 'seat-header';

                const badge = document.createElement('div');
                badge.className = 'seat-name';
                badge.textContent = seatLabel(i);

                const cap = document.createElement('div');
                cap.className = 'seat-capacity';
                cap.textContent = `定員 ${capacity}`;

                const people = document.createElement('div');
                people.className = 'people';

                header.appendChild(badge);
                header.appendChild(cap);
                seat.appendChild(header);
                seat.appendChild(people);
                container.appendChild(seat);
            }
        }

        // 参加者を席に割り当て
        function assignParticipants(participants, seatCount, capacity) {
            const seats = Array.from({ length: seatCount }, () => []);
            const shuffled = shuffle(participants);
            let idx = 0;

            for (const name of shuffled) {
                let placed = false;
                for (let r = 0; r < seatCount; r++) {
                    const target = (idx + r) % seatCount;
                    if (seats[target].length < capacity) {
                        seats[target].push(name);
                        placed = true;
                        break;
                    }
                }
                idx++;
                if (!placed) break; // 全席満席
            }
            return seats;
        }

        // 可視化（アニメーション付き）
        function renderAssignments(container, seatToPeople) {
            const seatEls = container.querySelectorAll('.seat');
            seatEls.forEach((seatEl, i) => {
                const peopleEl = seatEl.querySelector('.people');
                peopleEl.innerHTML = '';
                const people = seatToPeople[i] || [];
                people.forEach((name, idx) => {
                    const chip = document.createElement('div');
                    chip.className = 'chip';
                    chip.style.setProperty('--delay', `${80 * idx}ms`);
                    chip.textContent = name;
                    peopleEl.appendChild(chip);
                });
            });
        }

        // 入力取得と検証
        function getInputs() {
            const seatCount = Math.max(1, Math.min(100, parseInt(document.getElementById('seatCount').value || '0', 10)));
            const capacity = Math.max(1, Math.min(20, parseInt(document.getElementById('capacity').value || '0', 10)));
            const participants = getParticipants();
            return { seatCount, capacity, participants };
        }

        // シャッフル実行
        function doShuffle() {
            const container = document.getElementById('seats');
            const { seatCount, capacity, participants } = getInputs();

            if (participants.length === 0) {
                alert('参加者を入力してください。');
                return;
            }

            buildSeats(container, seatCount, capacity);

            // 軽い浮遊アニメーションの演出（シャッフル中）
            container.classList.add('floating');
            setTimeout(() => {
                const assigned = assignParticipants(participants, seatCount, capacity);
                renderAssignments(container, assigned);
                container.classList.remove('floating');
            }, 280);
        }

        // クリア
        function doClear() {
            const container = document.getElementById('seats');
            container.innerHTML = '';
        }

        // 初期描画
        (function init() {
            const container = document.getElementById('seats');
            const { seatCount, capacity } = getInputs();
            buildSeats(container, seatCount, capacity);
        })();

        document.getElementById('shuffleBtn').addEventListener('click', doShuffle);
        document.getElementById('clearBtn').addEventListener('click', doClear);
    </script>
</body>
</html>